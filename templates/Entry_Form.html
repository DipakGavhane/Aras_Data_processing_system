{% include "header.html" %}

<div class="container my-5 d-flex justify-content-center">
    <div class="form_container">
        <form action="/fetch_data" method="post">
            <label for="startRollNumber">Starting Roll Number:</label>
            <input type="text" id="startRollNumber" name="startRollNumber" pattern="\d{2}[A-Z]{2}\d{6}"
                placeholder="Ex. 22AK111401" required oninput="calculateTotal()">

            <label for="endRollNumber">Ending Roll Number:</label>
            <input type="text" id="endRollNumber" name="endRollNumber" pattern="\d{2}[A-Z]{2}\d{6}"
                placeholder="Ex. 22AK111450" required oninput="calculateTotal()">

            <p id="totalCount"></p>

            <label for="course">Course:</label>
            <select id="course" name="course" class="placeholder1" onchange="updateSemesters()">
                <option value="" disabled selected>Select</option>
                <option value="C000012">BCA</option>
                <option value="C000009">BBA</option>
                <option value="C000013">BTech</option>
            </select>

            <label for="session">Session:</label>
            <select id="session" name="session" class="placeholder1">
                <option value="" disabled selected>Select Session</option>
                <option value="SE08">Summer 2018</option>
                <option value="SE09">Winter 2018</option>

                <option value="SE10">Summer 2019</option>
                <option value="SE11">Winter 2019</option>

                <option value="SE12">Summer 2020</option>
                <option value="SE13">Winter 2020</option>

                <option value="SE14">Summer 2021</option>
                <option value="SE15">Winter 2021</option>

                <option value="SE16">Summer 2022</option>
                <option value="SE17">Winter 2022</option>

                <option value="SE18">Summer 2023</option>
                <option value="SE19">Winter 2023</option>

                <option value="SE20">Summer 2024</option>
                <option value="SE21">Winter 2024</option>
            </select>

            <label for="semester">Semester:</label>
            <select id="semester" name="semester" class="placeholder1">
                <option value="" disabled selected>Select Semester</option>
                <option value="SM01">First Semester (Sem - 1)</option>
                <option value="SM02">Second Semester (Sem - 2)</option>
                <option value="SM03">Third Semester (Sem - 3)</option>
                <option value="SM04">Fourth Semester (Sem - 4)</option>
                <option value="SM05">Fifth Semester (Sem - 5)</option>
                <option value="SM06">Six Semester (Sem - 6)</option>
                <option value="SM07">Seven Semester (Sem - 7)</option>
                <option value="SM08">Eight Semester (Sem - 8)</option>
                <option value="SM09">Nine Semester (Sem - 9)</option>
                <option value="SM10">Ten Semester (Sem - 10)</option>
            </select>

            <label for="resultType">Result Type: </label>
            <select id="resultType" name="resultType" class="placeholder1">
                <option value="" disabled selected>Select Result Type</option>
                <option value="R">Regular</option>
                <option value="B">Back</option>
                <option value="RV">Reval</option>
                <option value="EV">EVS</option>
            </select>

            <button type="submit" id="submitBtn">Submit</button>
        </form>
    </div>
</div>

<script>
    // Get all select elements
    const selects = document.querySelectorAll('.placeholder1');

    selects.forEach(select => {
        select.addEventListener("change", function () {
            this.classList.add("valid");
        });
    });

    // Arrenge the semester count as per course
    function updateSemesters() {
        let course = document.getElementById('course').value;
        let semesterSelect = document.getElementById('semester');
        semesterSelect.innerHTML = '';  // Clear the select field

        let totalSemesters = 0;
        if (course === 'C000012' || course === 'C000009') {
            totalSemesters = 6;
        } else if (course === 'C000013') {
            totalSemesters = 8;
        }

        // Generate the semester options
        let optionsHTML = '';
        for (let i = 0; i <= totalSemesters; i++) {
            let semesterText = "";  // Label text for display

            // Create the semester text based on the number
            switch (i) {
                case 0:
                    semesterText = `Select Semester`;
                    break;
                case 1:
                    semesterText = `First Semester (Sem - ${i})`;
                    break;
                case 2:
                    semesterText = `Second Semester (Sem - ${i})`;
                    break;
                case 3:
                    semesterText = `Third Semester (Sem - ${i})`;
                    break;
                case 4:
                    semesterText = `Fourth Semester (Sem - ${i})`;
                    break;
                case 5:
                    semesterText = `Fifth Semester (Sem - ${i})`;
                    break;
                case 6:
                    semesterText = `Sixth Semester (Sem - ${i})`;
                    break;
                case 7:
                    semesterText = `Seventh Semester (Sem - ${i})`;
                    break;
                case 8:
                    semesterText = `Eighth Semester (Sem - ${i})`;
                    break;
            }

            // Add the option element with unchanged value
            optionsHTML += `<option value="SM0${i}">${semesterText}</option>`;
        }

        // Update the select field once
        semesterSelect.innerHTML = optionsHTML;
    }

   // Total Students Count
    function calculateTotal() {
        let startRoll = document.getElementById('startRollNumber').value;
        let endRoll = document.getElementById('endRollNumber').value;
        let totalCountElement = document.getElementById('totalCount');
        let submitButton = document.getElementById('submitBtn'); // Assuming your submit button has this ID

        if (startRoll.length === 10 && endRoll.length === 10) {
            let startNum = parseInt(startRoll.slice(-3));
            let endNum = parseInt(endRoll.slice(-3));

            if (!isNaN(startNum) && !isNaN(endNum) && endNum >= startNum) {
                let total = endNum - startNum + 1;
                totalCountElement.textContent = `Total Students: ${total}`;
                submitButton.disabled = false; // Enable submit button
            } else {
                totalCountElement.textContent = "Invalid range!";
                submitButton.disabled = true; // Disable submit button
            }
        } else {
            totalCountElement.textContent = "";
            submitButton.disabled = true; // Disable submit button if input is incomplete
        }
    }

    // Ensure the button is disabled on page load
    document.addEventListener("DOMContentLoaded", function() {
        document.getElementById('submitBtn').disabled = true;
    });
</script>

{% include "footer.html" %}